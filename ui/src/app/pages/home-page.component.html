<div class="p-4">
  <!-- Hero y búsqueda -->
  <div class="container stack">
    <header class="hero">
      <h1>Gestión de partidos de Baloncesto</h1>
      <p class="muted">Hecho por Grupo #9</p>
    </header>
  </div>

  <section class="container grid-2">
    <!-- Panel de partidos -->
    <div class="card p-3">
      <div class="card-header">
        <div class="card-title">Partidos</div>
        <div class="card-subtitle">Lista de los últimos 50</div>
      </div>

      <ul class="divider-y">
        <li *ngFor="let g of games | slice:0:50" class="py-3">
          <div style="display:grid; grid-template-columns: 1fr auto; gap:.5rem; align-items:center;">
            <div>
              <a [routerLink]="['/display', g.gameId]" class="font-medium">{{ g.homeTeam }} vs {{ g.awayTeam }}</a>
              <div class="text-xs muted">Q{{ g.quarter }}</div>
            </div>
            <div class="row">
              <span class="pill"
                    [ngClass]="{
                      'pill-finished': g.status==='FINISHED',
                      'pill-inprogress': g.status==='IN_PROGRESS',
                      'pill-scheduled': g.status==='SCHEDULED'
                    }">
                {{ g.status | lowercase | titlecase }}
              </span>
              <button class="btn btn-ghost btn-sm" [routerLink]="['/results']" [queryParams]="{ id: g.gameId }">Ver</button>
            </div>
          </div>
        </li>
      </ul>

      <!-- Crear partido emparejando por IDs -->
      <div class="mt-4 pt-3">
        <div class="font-semibold mb-2" style="text-align:center;">Crear enfrentamiento</div>
        <div style="display:flex; justify-content:center; width:100%;">
          <div class="input-group" style="width:100%; max-width:640px; margin-bottom:10px;">
            <div class="field" style="flex:1; min-width:220px;">
              <label>Equipo local</label>
              <select #homeSel class="select">
                <option [value]="0">Locales</option>
                <option *ngFor="let t of teams" [value]="t.teamId">{{ t.name }}</option>
              </select>
            </div>
            <div class="field" style="flex:1; min-width:220px;">
              <label>Equipo visitante</label>
              <select #awaySel class="select">
                <option [value]="0">Visitantes</option>
                <option *ngFor="let t of teams" [value]="t.teamId">{{ t.name }}</option>
              </select>
            </div>
          </div>
        </div>
        <div style="display:flex; justify-content:center; width:100%;">
          <button
            class="btn btn-success"
            [disabled]="creating"
            (click)="createGame(+homeSel.value, +awaySel.value)"
            style="min-width:200px;">
            {{ creating ? 'Creando…' : 'Crear' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Lista de equipos -->
    <div class="card p-3">
      <div class="card-header" style="display:block; text-align:center;">
        <div class="card-title" style="margin-bottom: 4px;">Equipos existentes</div>
        <div class="card-subtitle" style="display:block;">Los últimos creados</div>
      </div>
      <div style="max-height: 320px; overflow: auto; margin-top: 6px; border-radius: 10px;">
        <ul class="list-clean text-sm" style="margin:0;">
          <li *ngFor="let t of teams" style="display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-bottom: 1px solid rgba(255,255,255,0.06);">
            <span>{{ t.name }}</span>
            <span class="text-xs" style="opacity:.7; border:1px solid rgba(255,255,255,0.18); padding:2px 8px; border-radius:999px;">#{{t.teamId}}</span>
          </li>
        </ul>
      </div>
    </div>

        <!-- Crear equipo -->
    <div class="card p-3">
      <div class="card-header" style="display:block; text-align:center;">
        <div class="card-title">Crear equipo</div>
      </div>
      <div class="input-group" style="margin-bottom: 10px;">
        <div class="field" style="flex:1; min-width:260px;">
          <label>Nombre del equipo</label>
          <input [(ngModel)]="newTeamName" placeholder="Ej. Los halcones" class="input" />
        </div>
      </div>
      <div style="display:flex; justify-content:center; width:100%; margin-bottom: 8px;">
        <button class="btn btn-success"
                [disabled]="creating || !newTeamName.trim()"
                (click)="createTeam()"
                style="min-width: 200px;">
          {{ creating ? 'Creando…' : 'Crear equipo' }}
        </button>
      </div>
      <div class="text-xs muted mt-1">* El nombre debe ser único.</div>
    </div>

    <!-- Gestión de jugadores por equipo (admin) -->
    <div class="mt-4">
      <app-admin-team-roster></app-admin-team-roster>
    </div>

    <!-- Detalle seleccionado -->
    <div class="card p-3" *ngIf="detail as d">
      <app-scoreboard [game]="d.game"></app-scoreboard>

      <div class="mt-3" style="display:flex; align-items:center; justify-content:space-between;">
        <app-control-panel [game]="d.game" (changed)="view(d.game.gameId)"></app-control-panel>
        <app-clock
          [gameId]="d.game.gameId"
          [status]="d.game.status"
          [quarter]="d.game.quarter"
          [showTeamFouls]="false"
          (expired)="onExpire()">
        </app-clock>

      </div>

      <div class="mt-4" style="display:grid; gap:1rem; grid-template-columns: 1fr 1fr;">
        <app-team-roster [gameId]="d.game.gameId" side="HOME"></app-team-roster>
        <app-team-roster [gameId]="d.game.gameId" side="AWAY"></app-team-roster>
      </div>
    </div>
  </section>
</div>

