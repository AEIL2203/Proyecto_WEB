<div class="card p-3">
  <div class="card-header" style="display:block; text-align:center;">
    <div class="card-title" style="margin-bottom:4px;">Controles</div>
    <div class="card-subtitle" style="display:block;">Gestiona el juego y registra eventos</div>
  </div>

  <!-- Acciones globales -->
  <div style="display:flex; justify-content:center; gap:8px; flex-wrap:wrap; margin-bottom:12px;">
    <button class="btn btn-success" (click)="start()"   [disabled]="game.status!=='SCHEDULED'">Start</button>
    <button class="btn btn-primary" (click)="advance()" [disabled]="!canAdvance()">{{getAdvanceButtonText()}}</button>
    <button class="btn btn-primary" (click)="finish()"  [disabled]="game.status!=='IN_PROGRESS'">Finish</button>
    <button class="btn btn-ghost"  (click)="undo()"    [disabled]="!game">Undo</button>
  </div>

  <!-- HOME -->
  <div class="card-subsection my-md">
    <div class="section-title">HOME</div>
    <div class="input-group" style="align-items:center;">
      <button class="btn btn-primary" (click)="score('HOME',1)" [disabled]="game.status!=='IN_PROGRESS'">+1</button>
      <button class="btn btn-primary" (click)="score('HOME',2)" [disabled]="game.status!=='IN_PROGRESS'">+2</button>
      <button class="btn btn-primary" (click)="score('HOME',3)" [disabled]="game.status!=='IN_PROGRESS'">+3</button>
      <button class="btn btn-ghost" (click)="removeScore('HOME')" [disabled]="game.status!=='IN_PROGRESS' || game.homeScore === 0">-Pts</button>

      <select [(ngModel)]="selHomePlayerId" class="select" [disabled]="!homePlayers.length">
        <option [ngValue]="undefined">Jugador HOME (opcional)</option>
        <option *ngFor="let p of homePlayers" [ngValue]="p.playerId">
          {{ p.number ? ('#'+p.number+' ') : '' }}{{ p.name }}{{ isPlayerOut(p) ? ' (OUT)' : '' }}
        </option>
      </select>

      <button class="btn btn-primary" (click)="foul('HOME')" [disabled]="game.status!=='IN_PROGRESS' || isSelectedPlayerOut('HOME')">+Foul</button>
      <button class="btn btn-ghost" (click)="removeFoul('HOME')" [disabled]="game.status!=='IN_PROGRESS' || teamFouls.home === 0">-Foul</button>
    </div>
    <div class="muted text-sm" [class.text-red-600]="teamFouls.home >= 5">
      Faltas HOME (Q{{game.quarter}}): {{ teamFouls.home }} {{ teamFouls.home >= 5 ? '(Penalización)' : '' }}
    </div>
  </div>

  <!-- AWAY -->
  <div class="card-subsection">
    <div class="section-title">AWAY</div>
    <div class="input-group" style="align-items:center;">
      <button class="btn btn-primary" (click)="score('AWAY',1)" [disabled]="game.status!=='IN_PROGRESS'">+1</button>
      <button class="btn btn-primary" (click)="score('AWAY',2)" [disabled]="game.status!=='IN_PROGRESS'">+2</button>
      <button class="btn btn-primary" (click)="score('AWAY',3)" [disabled]="game.status!=='IN_PROGRESS'">+3</button>
      <button class="btn btn-ghost" (click)="removeScore('AWAY')" [disabled]="game.status!=='IN_PROGRESS' || game.awayScore === 0">-Pts</button>

      <select [(ngModel)]="selAwayPlayerId" class="select" [disabled]="!awayPlayers.length">
        <option [ngValue]="undefined">Jugador AWAY (opcional)</option>
        <option *ngFor="let p of awayPlayers" [ngValue]="p.playerId">
          {{ p.number ? ('#'+p.number+' ') : '' }}{{ p.name }}{{ isPlayerOut(p) ? ' (OUT)' : '' }}
        </option>
      </select>

      <button class="btn btn-primary" (click)="foul('AWAY')" [disabled]="game.status!=='IN_PROGRESS' || isSelectedPlayerOut('AWAY')">+Foul</button>
      <button class="btn btn-ghost" (click)="removeFoul('AWAY')" [disabled]="game.status!=='IN_PROGRESS' || teamFouls.away === 0">-Foul</button>
    </div>
    <div class="muted text-sm" [class.text-red-600]="teamFouls.away >= 5">
      Faltas AWAY (Q{{game.quarter}}): {{ teamFouls.away }} {{ teamFouls.away >= 5 ? '(Penalización)' : '' }}
    </div>
  </div>
</div>
